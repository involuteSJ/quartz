---
CMDS: "[[108 Engineer Information Security]]"
creation date: 2025-04-10 16:50
modification date: 2025-04-10 16:50:59
type:
  - note
tags:
  - "#Private_key"
관련 문서:
  - "[[108.01 Basic Concept]]"
category: content
---

# 비대칭키
## 키 배송 문제
- 키가 없으면 수신자는 복호화 불가
- 암호화하지 않으면 도청자가 복호화 가능

#### 해결방안
- 키 사전 공유
- 온라인 키 분배
- Diffie-Hellman 키 교환
- 공개키 암호
##### 1. 키 사전 공유
- 키 관리 기관(TA, trusted authority)이 사전에 비밀 경로로 임의 키를 전달
- 사용자는 다른 사용자와의 키가 있어야 하며, 키 관리 기관은 $\frac {n(n-1)}{2}$개의 키가 필요
##### 2. 온라인 키 분배
- 암호 통신이 필요한 경우 키배포 센터(KDC)가 키를 공유
- n개의 키만으로 관리 가능
- ###### 통신 과정
	1. 앨리스가 밥에게 통신하고 싶다고 신청
	2. KDC가 의사난수 생성기로 세션키(K)를 만든다
	3. KDC가 앨리스의 키(KA)와 밥의 키(KB)를 꺼낸다
	4. KDC가 **앨리스의 키로 세션키를 암호화**$(C_A=E_{KA}(K))$시켜 앨리스에게 보냄
	5. KDC가 **밥의 키로 세션키를 암호화**$(C_B = E_{KB}(K))$시켜 밥에게 보냄
	6. **앨리스**가 세션키를 **복호화**해서 세션키를 얻음 $(K=D_{KA}(C_A))$
	7. 세션키를 사용하여 **메일을 암호화**하여 밥에게 보냄 $(C=E_K(M))$
	8. **밥**이 세션키를 **복호화**해서 세션키를 얻음 $(K=D_{KB}(C_B))$
	9. 세션키로 앨리스의 **암호문을 복호화** $(M=D_K(C))$
	10. 세션키 삭제
##### 3. Diffie-Hellman 키 교환
- 매우 큰 소수 p, g 선택
- 키를 교환한다기 보다 계산하는 것
- ###### 과정
	1. 앨리스가 임의의 큰 수 $x$를 $0 \le x \le p-1$ 안에서 선택 후 $R_1=g^x mod\, p$ 계산
	2. 밥이 임의의 큰 수 $y$를 $0 \le y \le p-1$ 안에서 선택 후 $R_2=g^y mod\, p$ 계산
	3. 앨리스 -> 밥 $R_1$ 전송
	4. 밥 -> 앨리스 $R_2$ 전송
	5. 앨리스가 키를 얻음 $K=(R_2)^x mod\, p$
	6. 밥이 키를 얻음 $K = (R_1)^ymod\,p$
- ###### 안전성
	- **이산대수 공격**
		- 이산대수 문제를 풀면 더 이상 비밀이 아니게 됨
	- **서비스 거부 공격**
		- 키를 만들어내는데 오랜 시간이 걸려 키 생성 부담으로 서버 마비
	- **중간자 공격**
		- 인증단계가 없기 때문에 중간자 공격에 취약
- ###### 응용
	- 중간자 공격
		- 메시지 인증으로 해결
	- DOS 공격
		- 쿠키를 사용함으로써 방지
##### 4. 공개키 암호에 의한 해결
- 암호화키와 복호화키가 다르기 때문에 암호화키는 외부에 알려져도 괜찮음
- 복호화키는 수신자가 알고 있음 => 키 배송의 문제 해결
![[Pasted image 20250410172713.jpg]]

## 공개키 암호
#### 개요
- 수학적으로 해결하기 힘든 문제로 기밀성 유지
- 공개키와 개인키는 서로 밀접한 관계 존재
- ![[Pasted image 20250410173035.jpg]]
#### 중간자 공격
- 기밀성에 매우 유효한 공격 방법
- 송신자에겐 수신자처럼, 수신자에겐 송신자처럼 행동
- 이를 방지하기 위해 공개키 인증서 사용

#### 대칭키 vs 비대칭키
##### 암호화 속도
- 비대칭키 : 느림
- 대칭키 : 빠름
##### 용도
- 비대칭키 : 인증, 전자서명
- 대칭키 : 평문

### RSA 암호시스템

<center><i><b>R</b>ivest <b>S</b>hamir <b>A</b>dleman</i></center>

- 공개키 암호 알고리즘의 사실상 표준
- SSL 프로토콜 웹, PGP, 정부시스템에서 사용

#### 암호화, 복호화
1. 두 지수  e(공개), d(비밀) / 평문 : P / 암호문 : C / n : 키 생성 프로세스로 만듦(1024 bit)
2. 앨리스가 $C = P^e mod\,n$으로 암호문 생성
3. 밥은 $P=C^dmod\,n$으로 평문 얻음
- ![[Pasted image 20250410174012.jpg]]
#### 키 생성
- 두 소수 $p, q$ (512 bit)고르기
- $N = pq$
- $\phi(N) = (p-1)(q-1)$
- $\phi(N)$ 보다 작고 서로소인 정수 e
- $de=1\,mod\,\phi(N)$ 인 d 구하기 (확장된 유클리드 호제법)

#### RSA 공격
- ##### 수학적 공격
	- 인수분해 노력
- ##### 타이밍 공격
	- 복호화 시간을 통해 키 길이를 추측
- ##### 선택 암호문 공격
	- 위조 암호문을 보내 서버에 회신해 주는 메시지나 타이밍을 해석해서 키나 평문 정보를 얻음
- ##### 최적 비대칭키 암호 패딩 OAEP
	- RSA 개량
	- 해시값 + 인증정보 => RSA 암호화
	- 올바른 인증정보가 아니면 오류 반환

### Rabin 암호시스템
- RSA 변형
- #### 암호화, 복호화
	- 한번의 연산으로 수행
	- 성능이 낮은 플랫폼에서 활용
- #### 보안
	- p, q가 충분히 크면 안전
	- RSA만큼 안전

### ELGamal
- 이산수학에 근거
- 속도가 가장 느림
- #### 특징
	- 암호문의 길이가 평문의 2배
	- 많은 메모리 공간 필요
- #### 응용
	- 키 교환, 인증, 짧은 메세지 암/복호화

### 타원 곡선 암호(ECC : Elliptic Curve Cryptosystem)
- 타원곡선 이론에 근거
- 기존 공개키 기반 암호보다 강력하고 효율적
- #### 특징
	- H/W , S/W 구현 용이 -> 무선단말, 스마트카드 등에 효율적
	- $E : y^2=x^3+ax+b$ 형태로 정의되는 타원곡선상 점들 간 덧셈 연산
	- 서로 다른 타원곡선 선택 가능
- #### 타원곡선 그래프
	- $4a^3+27b^2\ne 0$  조건 만족
	- ![[Pasted image 20250411170609.jpg]]
	- P, Q를 연결하는 선을 그리고, 선과 만나는 교점, 교점과 x축 대칭인 점 R = P+Q
- #### ECDLP 문제
	- 타원곡선 이산대수 문제
		- 어떤 두 점 P, Q가 주어졌을 때 Q=kP를 만족하는 수 k를 구하여라

### 대칭키와 비대칭키의 비교
- 대칭키 : 기호를 대체하거나 전치하는데 기반
- 비대칭키 : 수학적 함수를 응용